import numpy as np
import matplotlib.pyplot as plt

#d = {'water': [(0.8873134493642003, 1.2540822306141264), (0.12680818485758294, 2.784158016161086), (1.2556914291375354, 2.3942925156490116), (2.799334205169208, 2.793371710128687)], 'pastures': [], 'seed': [(0.4938548570852421, 2.404726109190621), (0.9034012490610992, 3.1646465144201708), (1.6555758637451992, 0.5821088577126128)], 'potato': [], 'soil': [(2.403254638234139, 0.5035148888594937)], 'water_land': [], 'seed_land': [[1.6343488134744035, 2.0689548225126213, 7]], 'pastures_land': []}

d = {'water': [np.array([[0.10335331, 2.7289498 ],
       [0.09998551, 2.7202981 ],
       [0.09078228, 2.7242744 ],
       [0.08227232, 2.72891739],
       [0.06443277, 2.72919095],
       [0.07229531, 2.72652773],
       [0.06832438, 2.71365121],
       [0.07530892, 2.70989318],
       [0.12743574, 2.68712754]]), np.array([[1.19808945, 2.35177597],
       [1.21271549, 2.33710049],
       [1.2155821 , 2.33190859],
       [1.21520114, 2.33231642],
       [1.27473347, 2.30992086],
       [1.28979041, 2.34627419],
       [1.22236178, 2.37626528],
       [1.19673951, 2.3770522 ],
       [1.21420838, 2.39086684],
       [1.22327774, 2.38570278],
       [1.22641694, 2.3793157 ],
       [1.24690487, 2.40139009],
       [1.23390718, 2.42893686],
       [1.23903521, 2.43970235],
       [1.26894561, 2.44600847],
       [1.25558327, 2.4554787 ],
       [1.2393149 , 2.46095592]]), np.array([[0.89943182, 1.18889859],
       [0.91422639, 1.20919386],
       [0.93045752, 1.23853605],
       [0.94144399, 1.23315655],
       [0.96152319, 1.24944834],
       [0.91081273, 1.20727392],
       [0.92981074, 1.21894265],
       [0.90712822, 1.20876599]]), np.array([[2.76251607, 2.84763765],
       [2.80544442, 2.85040336],
       [2.74529714, 2.8507295 ],
       [2.73275738, 2.84682476],
       [2.74248089, 2.84932352]])], 'pastures': [], 'seed': [np.array([[0.49181835, 2.35431406],
       [0.48218878, 2.34306193],
       [0.47792787, 2.33435199],
       [0.46550116, 2.33501355],
       [0.45790878, 2.33614394],
       [0.44046599, 2.34363138],
       [0.45625324, 2.33932194],
       [0.44587989, 2.32276396],
       [0.45134097, 2.32671063],
       [0.50655981, 2.30610503],
       [0.50514957, 2.34309648]]), np.array([[0.86004808, 3.10401988],
       [0.85416834, 3.10766722],
       [0.84331632, 3.10764297],
       [0.8292371 , 3.11570023],
       [0.83415592, 3.10640856],
       [0.83403599, 3.1073814 ],
       [0.83027016, 3.14976483],
       [0.83826274, 3.14457556],
       [0.83122558, 3.15277241]]), np.array([[1.79666234, 0.49950394],
       [1.78768497, 0.50118587],
       [1.76801559, 0.50619114],
       [1.72790297, 0.48252521],
       [1.69583756, 0.47471438],
       [1.66985291, 0.53507843],
       [1.68953066, 0.5440252 ],
       [1.71948815, 0.5506562 ],
       [1.73398686, 0.55311744],
       [1.73019175, 0.56929333],
       [1.73953869, 0.56330732],
       [1.71248325, 0.58501305],
       [1.70366653, 0.58467233]])], 'potato': [], 'soil': [np.array([[2.44356786, 0.53768707],
       [2.46392257, 0.5526218 ],
       [2.49198672, 0.56204168],
       [2.50328559, 0.56850753],
       [2.51193523, 0.58344927],
       [2.50595208, 0.58320444],
       [2.4860253 , 0.59731058],
       [2.47381977, 0.6019328 ],
       [2.48034998, 0.58616916],
       [2.49724098, 0.53559099],
       [2.4868364 , 0.5453644 ],
       [2.48779574, 0.54023687],
       [2.49654979, 0.50012671]])], 'water_land': [], 'seed_land': [np.array([[1.67080095, 2.00419496],
       [1.61037212, 2.00385008],
       [1.58476213, 2.00557337],
       [1.60070904, 2.01533332],
       [1.60526019, 2.02000437],
       [1.61318457, 2.0501141 ],
       [1.61041572, 2.06628262],
       [1.66123584, 2.07131406],
       [1.64768817, 2.0796835 ],
       [1.63007379, 2.08657626]])], 'pastures_land': []}

field = {
    'seed': [(1.662, 0.528), (0.906, 3.174), (0.528, 2.418)],
    'seed_land': [(0.15, 3.552)],
    'water': [(0.15, 2.796), (1.284, 2.418), (0.906, 1.284), (2.796, 2.796)],
    'water_land': [(3.552, 0.15)],
    'pastures': [(1.284, 1.284)],
    'pastures_land': [(3.552, 3.552)],
    'potato': [(2.418, 0.528)],
    'soil': [(2.418, 2.04)]
}

TH = 1
mapping = {
    'water': 'b',
    'pastures': 'g',
    'seed': 'y',
    'potato': 'r',
    'soil': 'm',
    'water_land': 'b',
    'seed_land': 'y',
    'pastures_land': 'g'
}

MODE = 1

deltas = []

def distance(p1, p2):
    return ((p1[0] - p2[0])**2 + (p1[1] - p2[1])**2)**0.5

for key in d:
    for i in range(len(d[key])):
        if len(d[key][i]) == 0: continue
        if MODE:
            temp = np.array(d[key][i])
            if len(temp.shape) == 1:
                d[key][i] = np.delete(d[key][i], 2)
                temp = np.array(d[key][i])
                m = np.array(temp)
            else:
                m = temp.mean(axis=0)
            # plt.plot(m[0], m[1], marker='o', color=mapping[key])
            min_ = 99999999999999
            for point in field[key]:
                dist = distance(m, (point[0], point[1]))
                if dist < min_  and dist < TH:
                    min_ = d
            if min_ != 99999999999999:
                deltas.append(min_)
        else:
            # plt.plot(d[key][i][0], d[key][i][1], marker='o', color=mapping[key])
            min_ = 99999999999999
            for point in field[key]:
                dist = distance(d[key][i], (point[0], point[1]))
                if dist < min_ and dist < TH:
                    min_ = dist
            if min_ != 99999999999999:
                deltas.append(min_)

print(sum(deltas)/len(deltas), max(deltas), min(deltas))   
# plt.show()
